// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "./generated/client"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

type ServiceCategoryFilterValue {
  name           TranslationText[]
  filteringValue String
  sortOrder      Int
}

model ServiceCategoryFilter {
  id              String                       @id @default(auto()) @map("_id") @db.ObjectId
  categoryId      String                       @db.ObjectId
  filterGroupName TranslationText[]
  filteringKey    String
  filterValues    ServiceCategoryFilterValue[]
  selectionType   ServiceFilterSelectionType
  sortOrder       Int
}

enum ServiceFilterSelectionType {
  multiSelect
  singleSelect
  range
}

model ServiceCategory {
  id                 String                       @id @default(auto()) @map("_id") @db.ObjectId
  createdByUserId    String
  name               TranslationText[]
  description        TranslationText[]
  metaTagDescription TranslationText[]
  metaTagTitle       TranslationText[]
  metaTagKeywords    TranslationText[]
  seo                TranslationText[]
  thumbnail          String
  createdAt          DateTime                     @default(now())
  updatedAt          DateTime                     @updatedAt()
  filters            ServiceCategoryFilterValue[]
  status             ServiceCategoryStatus        @default(active)
  sortOrder          Int                          @default(1)
  type               ServiceType                  @unique
}

model SavedService {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  serviceId String @db.ObjectId
  userId    String @db.ObjectId

  @@unique([serviceId, userId])
}

enum ServiceCategoryStatus {
  active
  inActive
}

model ServiceWorkingSchedule {
  id                  String                          @id @map("_id") @db.ObjectId
  sellerId            String                          @unique
  weekdays            ServiceWeekDaysWorkingHours?
  specialDays         ServiceSpecialWorkingHoursDay[]
  HotelService        HotelService?
  HealthCenterService HealthCenterService[]
  BeautyCenterService BeautyCenterService[]
  VehicleService      VehicleService[]
}

model ServiceOwnerShip {
  id          String      @id @default(auto()) @map("_id") @db.ObjectId
  ownerId     String      @unique @db.ObjectId
  serviceId   String      @unique @db.ObjectId
  serviceType ServiceType
}

// ------------------------------------------------services------------------------------------------------------------

model Service {
  id                String                       @id @default(auto()) @map("_id") @db.ObjectId
  sellerId          String                       @unique @db.ObjectId
  name              TranslationText[]
  description       TranslationText[]
  price             Float
  thumbnail         String
  rating            Float                        @default(0)
  reviews           Int                          @default(0)
  discount          ServiceDiscount?
  cancelable        Boolean
  cancelationPolicy CancelationType
  type              ServiceType
  createdAt         DateTime                     @default(now())
  updatedAt         DateTime                     @updatedAt
  dayClicksId       String?
  status            ServiceStatus                @default(inActive)
  presentations     ServicePresentation[]
  policies          ServiceTranslationPolicies[]
  payment_methods   ServicePaymentMethods[]
  vat               Float
  suspensionReason  String?
  discountId        String?
  hashtags          String[]
  isExternal        Boolean                      @default(false)

  // hotel
  includedServices  TranslationArrayText[]
  popularAmenities  TranslationArrayText[]
  extras            ServiceExtra[]
  includedAmenities TranslationArrayText[]
  measurements      PropertyMeasurements?
  dailyPrices       ServiceDailyPrices?
  dailyPrice        Boolean                @default(false)
  beds              Int?
  num_of_rooms      Int?
  bedrooms          Int?
  units             Int?

  // rentals
  typeOfPlace  RentalTypeOfPlace?
  // <= moved to category
  propertyType RentalPropertyType?
  //  <= moved to category
  cleaningFee  Float?

  // hotel + rentals + vehicle
  deposit       Boolean?
  depositAmount Int?

  adaptedFor  Adaptation[]
  restriction Restriction[]

  // vehicle
  brand             String?
  model             String?
  properties        VehicleProperties?
  vehicleCategoryId String?

  // beauty center 
  treatmentCategoryId String?
  duration            Int?
  // seats               Int?

  // health center
  speakingLanguages     HealthCenterDoctorSpeakingLanguage[]
  sessionDurationMins   Int?
  availableAppointments DateTime[]

  specialityId String?

  // restaurant table
  ingredients TranslationArrayText[]
  menuType    RestaurantDishType?
  // <= moved to category
  // tables      Int?

  // categories Category[]
}

type Category {
  label      String
  categoryId String
  value      String
  position   String
}

enum Adaptation {
  newBorn
  children
  wheelchair
}

enum Restriction {
  event
  smoking
  pets
}

enum CancelationType {
  simple
  moderate
  strict
}

enum RentalTypeOfPlace {
  entire
  shared
}

enum RentalPropertyType {
  flat
  house
  appertemant
  studio
  villa
}

model RestaruantTable {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  sellerId String

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model TreatmentSeat {
  id String @id @default(auto()) @map("_id") @db.ObjectId

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model BookedService {
  id            String              @id @default(auto()) @map("_id") @db.ObjectId
  serviceId     String              @db.ObjectId
  ownerId       String              @db.ObjectId
  providerId    String              @db.ObjectId
  createdAt     DateTime            @default(now())
  updatedAt     DateTime            @updatedAt
  purchased     Boolean             @default(false)
  status        BookedServiceStatus @default(pending)
  type          ServiceType
  originalTotal Float?
  total         Float?
  payment       String?
  rejectReason  String?
  checkin       DateTime
  checkout      DateTime?
  guests        Int
  extrasIds     String[]
  discountId    String?
  cashbackId    String?
}

enum BookedServiceStatus {
  completed
  continuing
  restitute
  canceled_by_buyer
  pending
  paid
}

model ServiceDayClicks {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  clicks    Int      @default(0)
  serviceId String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model HotelService {
  id                  String                       @id @default(auto()) @map("_id") @db.ObjectId
  ownerId             String                       @unique @db.ObjectId
  createdAt           DateTime                     @default(now())
  updatedAt           DateTime                     @updatedAt
  status              ServiceStatus                @default(inActive)
  presentations       ServicePresentation[]
  serviceMetaInfo     ServiceMetaTranslationInfo[]
  contact             ServiceContact
  workingHours        ServiceWorkingSchedule?      @relation(fields: [ownerId], references: [id])
  policies            ServiceTranslationPolicies[]
  payment_methods     ServicePaymentMethods[]
  location            Location
  vat                 Int                          @default(0)
  cancelationPolicies ServiceCancelationPolicy[]
  rooms               HotelRoom[]
  lowest_price        Float                        @default(0)
  highest_price       Float                        @default(0)
}

model RestaurantService {
  id                     String                       @id @default(auto()) @map("_id") @db.ObjectId
  ownerId                String                       @unique @db.ObjectId
  createdAt              DateTime                     @default(now())
  updatedAt              DateTime                     @updatedAt
  vat                    Int                          @default(0)
  status                 ServiceStatus                @default(inActive)
  presentations          ServicePresentation[]
  policies               ServiceTranslationPolicies[]
  serviceMetaInfo        ServiceMetaTranslationInfo[]
  payment_methods        ServicePaymentMethods[]
  cancelationPolicies    ServiceCancelationPolicy[]
  contact                ServiceContact
  location               Location
  lowest_price           Float                        @default(0)
  highest_price          Float                        @default(0)
  menus                  RestaurantMenu[]
  establishmentTypeId    String                       @db.ObjectId
  cuisinesTypeId         String                       @db.ObjectId
  setting_and_ambianceId String                       @db.ObjectId
  michelin_guide_stars   Int
  rating                 Float                        @default(0)
  reviews                Int                          @default(0)
}

model HealthCenterService {
  id                  String                       @id @default(auto()) @map("_id") @db.ObjectId
  ownerId             String                       @db.ObjectId
  createdAt           DateTime                     @default(now())
  updatedAt           DateTime                     @updatedAt
  vat                 Float                        @default(0)
  rating              Float                        @default(0)
  totalReviews        Int                          @default(0)
  lowest_price        Float                        @default(0)
  highest_price       Float                        @default(0)
  status              ServiceStatus                @default(inActive)
  location            Location
  presentations       ServicePresentation[]
  policies            ServiceTranslationPolicies[]
  serviceMetaInfo     ServiceMetaTranslationInfo[]
  payment_methods     ServicePaymentMethods[]
  cancelationPolicies ServiceCancelationPolicy[]
  contact             ServiceContact
  doctors             HealthCenterDoctor[]
  workingHours        ServiceWorkingSchedule       @relation(fields: [ownerId], references: [id])
}

model BeautyCenterService {
  id                   String                       @id @default(auto()) @map("_id") @db.ObjectId
  ownerId              String                       @db.ObjectId
  createdAt            DateTime                     @default(now())
  updatedAt            DateTime                     @updatedAt
  vat                  Float                        @default(0)
  rating               Float                        @default(0)
  totalReviews         Int                          @default(0)
  beauty_center_typeId String                       @db.ObjectId
  lowest_price         Float                        @default(0)
  heigest_price        Float                        @default(0)
  location             Location
  status               ServiceStatus                @default(inActive)
  presentations        ServicePresentation[]
  policies             ServiceTranslationPolicies[]
  serviceMetaInfo      ServiceMetaTranslationInfo[]
  payment_methods      ServicePaymentMethods[]
  cancelationPolicies  ServiceCancelationPolicy[]
  type_of_seller       ServiceTypeOfSeller
  treatments           BeautyCenterTreatment[]
  workingHours         ServiceWorkingSchedule       @relation(fields: [ownerId], references: [id])
}

model VehicleService {
  id                  String                       @id @default(auto()) @map("_id") @db.ObjectId
  ownerId             String                       @db.ObjectId
  createdAt           DateTime                     @default(now())
  updatedAt           DateTime                     @updatedAt
  vat                 Float                        @default(0)
  rating              Float                        @default(0)
  totalReviews        Int                          @default(0)
  lowest_price        Float                        @default(0)
  highest_price       Float                        @default(0)
  status              ServiceStatus                @default(active)
  location            Location
  presentations       ServicePresentation[]
  policies            ServiceTranslationPolicies[]
  serviceMetaInfo     ServiceMetaTranslationInfo[]
  payment_methods     ServicePaymentMethods[]
  cancelationPolicies ServiceCancelationPolicy[]
  vehicles            Vehicle[]
  contact             ServiceContact
  workingHours        ServiceWorkingSchedule       @relation(fields: [ownerId], references: [id])
}

// model VehicleType {
//   id          String            @id @default(auto()) @map("_id") @db.ObjectId
//   createdById String            @db.ObjectId
//   createdAt   DateTime          @default(now())
//   updatedAt   DateTime          @updatedAt
//   name        TranslationText[]
// }

model BeautyCenterTreatmentCategory {
  id          String                  @id @default(auto()) @map("_id") @db.ObjectId
  createdById String
  createdAt   DateTime                @default(now())
  updatedAt   DateTime                @updatedAt
  title       TranslationText[]
  status      TreatmentCategoryStatus @default(active)
}

model HealthCenterDoctor {
  id                String                               @id @default(auto()) @map("_id") @db.ObjectId
  healthCenter      HealthCenterService                  @relation(fields: [healthCenterId], references: [id])
  speciality        HealthCenterSpecialty                @relation(fields: [specialityId], references: [id])
  speakingLanguages HealthCenterDoctorSpeakingLanguage[]
  healthCenterId    String                               @db.ObjectId
  specialityId      String                               @db.ObjectId
  rating            Float                                @default(0)
  name              String
  thumbnail         String
  price             Float
  description       TranslationText[]
  availablityStatus HealthCenterDoctorAvailablityStatus  @default(unavailable)
  serviceId         String?                              @db.ObjectId
}

model HealthCenterSpecialty {
  id          String               @id @default(auto()) @map("_id") @db.ObjectId
  doctors     HealthCenterDoctor[]
  name        TranslationText[]
  description TranslationText[]
  createdAt   DateTime             @default(now())
  updatedAt   DateTime             @updatedAt
}

model RestaurantEstablishmentType {
  id          String            @id @default(auto()) @map("_id") @db.ObjectId
  name        TranslationText[]
  status      ServiceStatus     @default(inActive)
  createdById String            @db.ObjectId
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
}

model RestaurantCuisinesType {
  id          String            @id @default(auto()) @map("_id") @db.ObjectId
  name        TranslationText[]
  status      ServiceStatus     @default(inActive)
  createdById String            @db.ObjectId
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
}

model RestaurnatSettingAndAmbiance {
  id          String            @id @default(auto()) @map("_id") @db.ObjectId
  name        TranslationText[]
  status      ServiceStatus     @default(inActive)
  createdById String            @db.ObjectId
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
}

model HotelRoom {
  id                  String                         @id @default(auto()) @map("_id") @db.ObjectId
  hotel               HotelService                   @relation(fields: [hotelId], references: [id])
  hotelId             String                         @db.ObjectId
  sellerId            String                         @db.ObjectId
  createdAt           DateTime                       @default(now())
  updatedAt           DateTime                       @updatedAt
  roomMetaInfo        HotelRoomTranslationMetaInfo[]
  status              ServiceStatus                  @default(active)
  pricePerNight       Float
  dailyPrice          Boolean
  beds                Int
  bathrooms           Int
  num_of_rooms        Int
  rating              Float                          @default(0)
  reviews             Int                            @default(0)
  ratingStars         Float                          @default(0)
  insurance           Float
  presentations       ServicePresentation[]
  dailyPrices         ServiceDailyPrices?
  discount            ServiceDiscount
  includedServices    TranslationArrayText[]
  popularAmenities    ServiceAmenity[]
  cancelationPolicies ServiceCancelationPolicy[]
  extras              ServiceExtra[]
  includedAmenities   TranslationArrayText[]
  measurements        PropertyMeasurements
  serviceId           String?                        @db.ObjectId
}

model Vehicle {
  id                  String                     @id @default(auto()) @map("_id") @db.ObjectId
  typeId              String                     @db.ObjectId
  title               TranslationText[]
  presentations       ServicePresentation[]
  brand               String
  model               String
  price               Int
  rating              Float                      @default(0)
  insurance           Float
  properties          VehicleProperties
  cancelationPolicies ServiceCancelationPolicy[]
  parantServiceId     String                     @db.ObjectId
  parantService       VehicleService             @relation(fields: [parantServiceId], references: [id])
  serviceId           String?                    @db.ObjectId
}

model ServiceInsurance {
  id        String                     @id @map("_id") @db.ObjectId
  bookId    String                     @unique
  sellerId  String
  buyerId   String
  amount    Float
  status    ServiceInsuranceStatusEnum
  createdAt DateTime                   @default(now())
  updatedAt DateTime                   @updatedAt
}

enum ServiceInsuranceStatusEnum {
  pending
  paid
  requested
  refused
  refunded
}

type VehicleProperties {
  seats           Int
  windows         Int
  maxSpeedInKm    Int
  lugaggeCapacity Int
  gpsAvailable    Boolean
  airCondition    Boolean
}

model RestaurantMenu {
  id           String            @id @default(auto()) @map("_id") @db.ObjectId()
  name         TranslationText[]
  restaurantId String            @db.ObjectId
  restaurant   RestaurantService @relation(fields: [restaurantId], references: [id])
  dishs        RestaurantDish[]
  serviceId    String?           @db.ObjectId
}

model RestaurantDish {
  id          String                 @id @default(auto()) @map("_id") @db.ObjectId()
  name        TranslationText[]
  price       Int
  ingredients TranslationArrayText[]
  type        RestaurantDishType
  thumbnail   String
  sales       Int                    @default(0)
  menuId      String                 @db.ObjectId
  menu        RestaurantMenu         @relation(fields: [menuId], references: [id])
}

enum RestaurantDishType {
  starter
  dessert
  main
  drinks
}

type HotelRoomMetaInfo {
  title       String
  description String
}

type HotelRoomTranslationMetaInfo {
  langId String
  value  HotelRoomMetaInfo
}

model BeautyCenterTreatment {
  id                    String               @id @default(auto()) @map("_id") @db.ObjectId
  treatmentCategoryId   String
  duration              Int[]
  title                 TranslationText[]
  price                 Float
  discount              ServiceDiscount
  BeautyCenterService   BeautyCenterService? @relation(fields: [beautyCenterServiceId], references: [id])
  beautyCenterServiceId String?              @db.ObjectId
  serviceId             String?              @db.ObjectId
  thumbnail             String
}

type ServiceWeekDaysWorkingHours {
  mo ServiceDayWorkingHours?
  tu ServiceDayWorkingHours?
  we ServiceDayWorkingHours?
  th ServiceDayWorkingHours?
  fr ServiceDayWorkingHours?
  sa ServiceDayWorkingHours?
  su ServiceDayWorkingHours?
}

type ServiceSpecialWorkingHoursDay {
  date         DateTime
  workingHours ServiceDayWorkingHours
}

type ServiceDayWorkingHours {
  periods DateTime[]
}

type PropertyMeasurements {
  inFeet  Float
  inMeter Float
}

type ServiceDailyPrices {
  mo Int?
  tu Int?
  we Int?
  th Int?
  fr Int?
  sa Int?
  su Int?
}

type ServiceExtra {
  name TranslationText[]
  cost Int
  id   String
}

type ServiceCancelationPolicy {
  duration Int
  cost     Int
}

type ServiceAmenity {
  value String
  label TranslationText[]
}

type ServiceDiscount {
  value Int
  units Int
}

type ServiceMetaInfo {
  title              String
  description        String
  metaTagDescription String
  metaTagKeywords    String[]
  hashtags           String[]
}

type ServiceMetaTranslationInfo {
  langId String
  value  ServiceMetaInfo
}

type ServiceContact {
  address String
  country String
  state   String?
  city    String
  email   String
  phone   String
}

type ServicePolicy {
  policyTitle String
  terms       String[]
}

type ServiceTranslationPolicies {
  langId String
  value  ServicePolicy[]
}

type ServicePresentation {
  type ServicePresentationType
  src  String
}

type TranslationText {
  langId String
  value  String
}

type TranslationArrayText {
  langId String
  value  String[]
}

type Location {
  address    String
  country    String
  state      String
  city       String
  lat        Float
  lon        Float
  postalCode Int
}

enum ServicePresentationType {
  img
  vid
}

enum ServiceType {
  hotel
  holiday_rentals
  restaurant
  health_center
  beauty_center
  vehicle
}

enum ServicePaymentMethods {
  credit_card
  visa
  mastercard
  check
  cash
}

enum ServiceStatus {
  inActive
  active
  suspended
}

enum HealthCenterDoctorAvailablityStatus {
  available
  unavailable
}

enum ServiceTypeOfSeller {
  individual
  professional
}

enum TreatmentCategoryStatus {
  active
  inActive
}

enum HealthCenterDoctorSpeakingLanguage {
  EN
  FR
  GE
  GD
}
